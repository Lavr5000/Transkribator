# –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏

## –ü—Ä–æ–±–ª–µ–º–∞
–¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –º–æ–¥–µ–ª—å—é `base`:
> "–ê —Ç–æ –ª—ã–±–∫–∏ —Å—Ç–∞–Ω–µ–∫ –≤—Å–µ–º —Å–∏–¥–ª–µ–π, –ê —Ç–æ –ª—ã–±–∫–∏ –≤ –Ω–µ–≤–µ—Ä–æ–≥–æ-–¥—Ä—É–≥–∞ –ø—Ä–æ—Å–Ω—É—Ç—Å—è..."

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏:
> "–û—Ç —É–ª—ã–±–∫–∏ —Å—Ç–∞–Ω–µ—Ç –≤—Å–µ–º —Å–≤–µ—Ç–ª–µ–π, –û—Ç —É–ª—ã–±–∫–∏ –≤ –Ω–µ–±–µ —Ä–∞–¥—É–≥–∞ –ø—Ä–æ—Å–Ω–µ—Ç—Å—è..."

## 4 –†–µ—à–µ–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –£–ª—É—á—à–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–¥–µ–ª—å `base` —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è –¥–ª—è —Ç–æ—á–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `small` –∫–∞–∫ –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π:**
- `tiny`: 60-70% —Ç–æ—á–Ω–æ—Å—Ç—å, —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è
- `base`: 75-80% —Ç–æ—á–Ω–æ—Å—Ç—å (–¢–ï–ö–£–©–ê–Ø)
- `small`: 85-90% —Ç–æ—á–Ω–æ—Å—Ç—å ‚úÖ **–¶–ï–õ–¨**
- `medium`: 90-95% —Ç–æ—á–Ω–æ—Å—Ç—å
- `large-v3`: 95-98% —Ç–æ—á–Ω–æ—Å—Ç—å, –º–µ–¥–ª–µ–Ω–Ω–∞—è

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í `config.py`: `model_size: str = "small"` (–≤–º–µ—Å—Ç–æ "base")
- –í UI: –≤—ã–¥–µ–ª–∏—Ç—å `small` –∫–∞–∫ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—É—é

**–ü–æ–ª—å–∑–∞:** +10-15% —Ç–æ—á–Ω–æ—Å—Ç–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç

---

### 2. –£–ª—É—á—à–µ–Ω–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —è–∑—ã–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** Auto-detect –º–æ–∂–µ—Ç –æ—à–∏–±–∞—Ç—å—Å—è, –æ—Å–æ–±–µ–Ω–Ω–æ —Å –∫–æ—Ä–æ—Ç–∫–∏–º–∏ —Ñ—Ä–∞–∑–∞–º–∏
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º "–Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —è–∑—ã–∫–∞ —Å fallback"

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `transcriber.py`:**
```python
def transcribe(self, audio, sample_rate=16000):
    # –ï—Å–ª–∏ —è–∑—ã–∫ —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
    # –ï—Å–ª–∏ auto - –ø—Ä–æ–±—É–µ–º detect_language –∏–∑ Whisper
    if self.language == "auto":
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –∏–∑ Whisper
        pass
```

**–ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ `config.py`:**
```python
# –†–µ–∂–∏–º—ã —è–∑—ã–∫–∞:
# - "auto": –∞–≤—Ç–æ–¥–µ—Ç–µ–∫—Ü–∏—è
# - "ru": —Ä—É—Å—Å–∫–∏–π
# - "en": –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
# –∏ —Ç.–¥.

# –î–æ–±–∞–≤–∏—Ç—å:
fallback_to_auto: bool = True  # –ï—Å–ª–∏ —è–≤–Ω—ã–π —è–∑—ã–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±–æ–≤–∞—Ç—å auto
```

**–ü–æ–ª—å–∑–∞:** +5-10% —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

---

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–π VAD (Voice Activity Detection)
**–°—Ç–∞—Ç—É—Å:** –£–ñ–ï –†–ê–ë–û–¢–ê–ï–¢, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å—Ç—Ä–æ–∫–∞ 159):**
```python
vad_parameters=dict(min_silence_duration_ms=500)
```

**–£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
vad_parameters=dict(
    min_silence_duration_ms=500,  # –º–∏–Ω. —Ç–∏—à–∏–Ω–∞ –¥–ª—è –ø–∞—É–∑—ã
    speech_pad_ms=30,             # –ø–∞–¥–¥–∏–Ω–≥ —Ä–µ—á–∏ (–ù–û–í–û–ï)
    max_speech_duration_s=30,     # –º–∞–∫—Å. –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ—Ä–∞–∑—ã (–ù–û–í–û–ï)
)
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–ª—å—Ç—Ä–∞:**
```python
# –í transcriber.py –ø–µ—Ä–µ–¥ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–µ–π:
def _preprocess_audio(self, audio: np.ndarray) -> np.ndarray:
    """–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ."""
    # 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏
    audio = audio / np.max(np.abs(audio))

    # 2. –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∏—à–∏–Ω—ã –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ
    # ... (–∏—Å–ø–æ–ª—å–∑—É–µ–º librosa –∏–ª–∏ numpy)

    return audio
```

**–ü–æ–ª—å–∑–∞:** +3-5% —Ç–æ—á–Ω–æ—Å—Ç–∏, –º–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –≤ –ø–∞—É–∑–∞—Ö

---

### 4. –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** "—Å—Ç–∞–Ω–µ–∫" ‚Üí "—Å—Ç–∞–Ω–µ—Ç", "—Å–∏–¥–ª–µ–π" ‚Üí "—Å–≤–µ—Ç–ª–µ–π"

**–†–µ—à–µ–Ω–∏–µ:** –ú–æ–¥—É–ª—å –ø–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—á–∞—Ç–æ–∫

**–ù–æ–≤—ã–π —Ñ–∞–π–ª: `src/text_processor.py`**
```python
"""Post-processing for transcribed text."""

import re
from typing import List, Tuple

class TextProcessor:
    """–£–ª—É—á—à–µ–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞."""

    def __init__(self, language: str = "ru"):
        self.language = language
        self._load_corrections()

    def process(self, text: str) -> str:
        """–ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –∫ —Ç–µ–∫—Å—Ç—É."""
        # 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ Whisper
        text = self._fix_whisper_errors(text)

        # 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
        text = self._fix_punctuation(text)

        # 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤
        text = self._fix_capitalization(text)

        return text

    def _fix_whisper_errors(self, text: str) -> str:
        """–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è."""
        corrections = {
            # –†—É—Å—Å–∫–∏–µ –∑–∞–º–µ–Ω—ã
            "—Å—Ç–∞–Ω–µ–∫": "—Å—Ç–∞–Ω–µ—Ç",
            "—Å–∏–¥–ª–µ–π": "—Å–≤–µ—Ç–ª–µ–π",
            "–ª—ã–±–∫–∏": "—É–ª—ã–±–∫–∏",
            "–Ω–µ–≤–µ—Ä–æ-–¥—Ä—É–≥–∞": "–Ω–µ–±–µ —Ä–∞–¥—É–≥–∞",
            "–ø–æ–π–ª–∏": "–ø–æ—è–≤–∏",
            "—Ä–∞—Å—Ç–µ–±–µ": "–∫ —Ç–µ–±–µ",

            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞...
        }

        for wrong, correct in corrections.items():
            text = text.replace(wrong, correct)

        return text
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `transcriber.py`:**
```python
def transcribe(self, audio, sample_rate=16000):
    # ... –æ–±—ã—á–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è ...

    raw_text = " ".join([segment.text for segment in segments])

    # –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞
    if self.text_processor:
        text = self.text_processor.process(raw_text)
    else:
        text = raw_text

    return text
```

**–ü–æ–ª—å–∑–∞:** +10-15% —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ —Ç–µ–∫—Å—Ç–µ

---

## –ù–æ–≤—ã–π —Ä–µ–∂–∏–º: "–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ"

**–î–æ–±–∞–≤–∏—Ç—å –≤ `config.py`:**
```python
# –†–µ–∂–∏–º—ã —Ç–æ—á–Ω–æ—Å—Ç–∏:
# - "speed": –±—ã—Å—Ç—Ä–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è (tiny/base)
# - "balanced": –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ (small) - –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ
# - "quality": –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (medium + –ø–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞)

quality_mode: str = "balanced"  # speed, balanced, quality
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞:**

| –†–µ–∂–∏–º | –ú–æ–¥–µ–ª—å | VAD | –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ | –°–∫–æ—Ä–æ—Å—Ç—å |
|-------|--------|-----|----------------|----------|
| `speed` | base | –ë–∞–∑–æ–≤—ã–π | –ù–µ—Ç | üöÄüöÄüöÄ |
| `balanced` | small | –£–ª—É—á—à–µ–Ω–Ω—ã–π | –ë–∞–∑–æ–≤–∞—è | üöÄüöÄ |
| `quality` | medium | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π | –ü–æ–ª–Ω–∞—è | üöÄ |

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ UI (`main_window.py`):**
- –î–æ–±–∞–≤–∏—Ç—å dropdown/combobox –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
- –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –≤ —Å—Ç–∞—Ç—É—Å–µ
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—ã–±–æ—Ä –≤ –∫–æ–Ω—Ñ–∏–≥

---

## –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ë–∞–∑–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–ø—Ä–æ—Å—Ç—ã–µ)
- [x] –ò–∑—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ `small`
- [ ] –£–ª—É—á—à–∏—Ç—å VAD –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–∑–∞ 2: –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞
- [ ] –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å `text_processor.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ transcriber
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –ø–µ—Å–Ω–∏

### –§–∞–∑–∞ 3: –†–µ–∂–∏–º—ã –∫–∞—á–µ—Å—Ç–≤–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å `quality_mode` –≤ config
- [ ] –û–±–Ω–æ–≤–∏—Ç—å UI –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–µ—Å–µ—Ç—ã –¥–ª—è —Ä–µ–∂–∏–º–æ–≤
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

### –§–∞–∑–∞ 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –ö–æ–º–º–∏—Ç –∏ push –≤ GitHub

---

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ —É–ª—É—á—à–µ–Ω–∏–π:**
> "–ê —Ç–æ –ª—ã–±–∫–∏ —Å—Ç–∞–Ω–µ–∫ –≤—Å–µ–º —Å–∏–¥–ª–µ–π, –ê —Ç–æ –ª—ã–±–∫–∏ –≤ –Ω–µ–≤–µ—Ä–æ–≥–æ-–¥—Ä—É–≥–∞ –ø—Ä–æ—Å–Ω—É—Ç—Å—è..."

**–ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:**
> "–û—Ç —É–ª—ã–±–∫–∏ —Å—Ç–∞–Ω–µ—Ç –≤—Å–µ–º —Å–≤–µ—Ç–ª–µ–π, –û—Ç —É–ª—ã–±–∫–∏ –≤ –Ω–µ–±–µ —Ä–∞–¥—É–≥–∞ –ø—Ä–æ—Å–Ω–µ—Ç—Å—è..."

**–£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏: 75% ‚Üí 95%+**

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–¥–µ–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. **–ê–≤—Ç–æ-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è —á–µ—Ä–µ–∑ Yandex Speller** (–æ–Ω–ª–∞–π–Ω)
2. **–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≥–æ–ª–æ—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (adaptation)
3. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è** (–∏—Å–ø–æ–ª—å–∑—É—è —è–∑—ã–∫–æ–≤—É—é –º–æ–¥–µ–ª—å)
4. **–ü—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤** (–º—É–∂—Å–∫–æ–π/–∂–µ–Ω—Å–∫–∏–π/–¥–µ—Ç—Å–∫–∏–π)
