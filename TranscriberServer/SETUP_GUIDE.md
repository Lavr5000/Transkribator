# Установка автозапуска Transcriber Server

## Вариант 1: Автоматическая удалённая настройка (РЕКОМЕНДУЕТСЯ)

### С ноутбука (один скрипт для всего):

1. Убедитесь что на ноутбуке установлен OpenSSH клиент:
   - Windows 10/11: Настройки → Приложения → Опциональные компоненты → Клиент OpenSSH

2. Запустите от имени администратора:
   ```batch
   TranscriberServer\REMOTE_SETUP.bat
   ```

3. Скрипт автоматически:
   - Скопирует файлы на удалённый ПК (192.168.31.9)
   - Настроит системный автозапуск
   - Проверит установку

4. Перезагрузите удалённый ПК для проверки

**Готово!** Сервер запустится автоматически при старте системы, даже без логина.

---

## Вариант 2: Ручная настройка на удалённом ПК

### Шаг 1: Скопировать файлы
Скопируйте папку `TranscriberServer/` на удалённый ПК в `C:\TranscriberServer\`

Файлы:
- `server.py`
- `transcriber_wrapper.py`
- `START_SERVER_BACKGROUND.bat`
- `install_scheduled_task_system.ps1`

### Шаг 2: Установить Scheduled Task
Откройте PowerShell от имени Администратора на удалённом ПК:
```powershell
cd C:\TranscriberServer
powershell -ExecutionPolicy Bypass -File install_scheduled_task_system.ps1
```

### Шаг 3: Проверить установку
1. Откройте Task Scheduler (Win+R → `taskschd.msc`)
2. Найдите задачу "TranscriberServer-System"
3. Проверьте что:
   - Триггер: "At Startup" (при старте системы)
   - Пользователь: "SYSTEM"
   - Запуск с наивысшими правами

### Шаг 4: Перезагрузить ПК
Перезагрузите удалённый ПК для проверки автозапуска.

---

## Проверка работы

### С ноутбука:
```bash
# Проверить health сервера
curl http://192.168.31.9:8000/health
```

Ожидаемый ответ:
```json
{"status": "healthy", "transcriber_loaded": true}
```

### На удалённом ПК:
```batch
# Проверить что процесс запущен
tasklist | findstr python

# Проверить логи
type C:\TranscriberServer\server_startup.log
type C:\TranscriberServer\server_output.log
```

---

## Режимы работы

### Режим 1: Фоновый (РЕКОМЕНДУЕТСЯ)
- Файл: `START_SERVER_BACKGROUND.bat`
- Окно консоли: скрыто
- Логирование: в файлы `server_output.log`

### Режим 2: С окном консоли
- Файл: `START_SERVER.bat`
- Окно консоли: видимо
- Удобно для отладки

### Режим 3: Полный (сервер + SSH туннель)
- Файл: `AUTOSTART_TRANSCRIBER_FULL.bat`
- Запускает сервер + Serveo.net туннель
- Автоматический перезапуск при обрыве

---

## Преимущества системного автозапуска

✅ **Не требует логина** - сервер запускается при старте Windows
✅ **Работает как SYSTEM** - максимальные права
✅ **Надёжность** - автоматический запуск при каждой загрузке
✅ **Фоновый режим** - не мешает работе на ПК
✅ **Удалённая настройка** - можно настроить с ноутбука по SSH

---

## Удаление

### Удалить Scheduled Task:
```powershell
# На удалённом ПК
Unregister-ScheduledTask -TaskName "TranscriberServer-System" -Confirm:$false
```

---

## Проблемы и решения

### Проблема: Сервер не запускается
**Решение:**
1. Проверьте логи: `server_output.log`
2. Убедитесь что Python установлен: `python --version`
3. Проверьте firewall: порт 8000 должен быть открыт

### Проблема: Не работает через SSH
**Решение:**
1. Установите OpenSSH Server на удалённом ПК
2. Проверьте что служба sshd запущена: `Get-Service sshd`

### Проблема: Нет прав для Scheduled Task
**Решение:**
Запустите PowerShell от имени Администратора

---

## Готово!

Теперь сервер запускается автоматически при старте системы, работает в фоне и не требует логина пользователя.
