---
wave: 2
depends_on: []
files_modified:
  - src/main_window.py
autonomous: true
must_haves:
  - WebRTC Enable/Disable toggle checkbox
  - Noise Suppression Level slider (0-4) with labels
  - Slider updates config.noise_suppression_level and config.webrtc_enabled
  - Settings persist on change
  - AudioRecorder restarts when WebRTC settings change
---

# Plan 04-04: Noise Reduction Settings in UI

**Objective:** Expose WebRTC noise reduction settings in the UI

## Tasks

<tasks>
<task id="04-04-01">
<summary>Create Noise Reduction group in SettingsDialog</summary>
<details>
- Add QGroupBox "Noise Reduction" to settings tab
- Place after VAD Settings group
- Use QVBoxLayout for the group
</details>
<verification>Noise Reduction group appears in settings</verification>
</task>

<task id="04-04-02">
<summary>Add WebRTC Enable checkbox</summary>
<details>
- Create QCheckBox "Enable WebRTC Processing"
- Maps to config.webrtc_enabled
- Add tooltip explaining WebRTC features (noise suppression + AGC)
- Checked by default (webrtc_enabled=True)
</details>
<verification>Checkbox controls WebRTC enable state</verification>
</task>

<task id="04-04-03">
<summary>Add Noise Suppression Level slider</summary>
<details>
- Create horizontal layout for noise level control
- Add QLabel "Suppression Level:"
- Add QSlider with range 0-4 (WebRTC standard levels)
- Add QLabel for numeric text value
- Add level labels below slider:
  * 0 = Off
  * 1 = Low
  * 2 = Moderate (default)
  * 3 = High
  * 4 = Very High
</details>
<verification>Slider shows 0-4 range with descriptive labels</verification>
</task>

<task id="04-04-04">
<summary>Add "Reset to Defaults" button for noise</summary>
<details>
- Create QPushButton "Reset Noise Defaults"
- Reset to: webrtc_enabled=True, noise_suppression_level=2
- Update checkbox and slider on reset
- Save config on reset
</details>
<verification>Button restores noise settings to defaults</verification>
</task>

<task id="04-04-05">
<summary>Implement noise setting change handlers</summary>
<details>
- Add _webrtc_enabled_changed(checked) method
  * Update config.webrtc_enabled
  * Call config.save()
  * Show warning: "Restart recording for changes to take effect"
- Add _noise_level_changed(int_value) method
  * Update config.noise_suppression_level
  * Update numeric label with text description
  * Call config.save()
  * Show warning about restart
</details>
<verification>Checkbox/slider changes update config and show restart warning</verification>
</task>

<task id="04-04-06">
<summary>Initialize noise controls from config</summary>
<details>
- In SettingsDialog.__init__:
  * Set checkbox from config.webrtc_enabled
  * Set slider from config.noise_suppression_level
  * Update text label with level description
- Connect controls to handlers after init
</details>
<verification>Controls show current config values on open</verification>
</task>

<task id="04-04-07">
<summary>Add visual indicator for noise reduction status</summary>
<details>
- Add small QLabel "(Active)" or "(Disabled)" next to checkbox
- Update when checkbox toggled
- Use accent color for "Active", muted for "Disabled"
</details>
<verification>Status indicator shows current state</verification>
</task>
</tasks>

## Success Criteria

- [ ] WebRTC Enable checkbox accessible
- [ ] Noise Level slider (0-4) accessible
- [ ] Changes persist to config.json
- [ ] User informed about restart requirement
- [ ] Clear visual feedback for current state

## UI Layout

```
┌─ Noise Reduction ───────────────────────┐
│ ☑ Enable WebRTC Processing (Active)    │
│                                         │
│ Suppression Level:                      │
│ [━━━●━━] Moderate                       │
│ Off | Low | Moderate | High | Very High│
│                                         │
│ [Reset to Defaults]                     │
└─────────────────────────────────────────┘
```

## Notes

- WebRTC requires AudioRecorder re-initialization to take effect
- AGC (Automatic Gain Control) is part of WebRTC, enabled together
- Consider adding live preview of noise reduction (future)
- Level 4 may cause audio artifacts; recommend 2-3 for most users
